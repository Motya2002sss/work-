# ДомЕда MVP

Локальный MVP маркетплейса домашней еды (Москва):
- любой повар после верификации и подписки может продавать блюда;
- покупатель выбирает блюда по району, рейтингу и способу доставки;
- доставка: самовывоз, доставка поваром, курьер на день.

## Стек на текущем этапе

- Frontend: `index.html`, `styles.css`, `app.js` (чистый JS)
- Карта: Yandex Maps JS API 2.1 (ключ вводится в интерфейсе)
- Страница заказа блюда: `dish.html`, `dish.js`
- Общая корзина клиента: `cart.js`
- Кабинет повара: `cook.html`, `cook.js`
- Экран заказов и трекинга: `orders.html`, `orders.js`
- Backend: `backend/server.py` (Python stdlib, без внешних зависимостей)
- Хранилище MVP: JSON-файлы в `backend/data`

## Быстрый запуск

1. Запустить сервер:
```bash
python3 backend/server.py
```

2. Открыть сайт:
```text
http://127.0.0.1:8080
```

3. Для живой карты и геокодирования:
- вставьте API-ключ Яндекс.Карт в блоке `Ключ Яндекс.Карт` на главной;
- нажмите `Подключить`.

## API (MVP)

- `GET /api/health` - проверка сервиса
- `GET /api/dishes` - блюда с фильтрами (`district`, `cook_id`, `categories`, `delivery`, `min_rating`, `max_price`, `search`, `sort`)
- `POST /api/dishes` - публикация блюда поваром (multipart: фото, цена, граммовка)
- `GET /api/dishes/<id>` - карточка блюда + повар + рекомендации
- `GET /api/dishes/<id>/reviews` - отзывы по блюду
- `GET /api/cooks` - список поваров
- `GET /api/cooks/map` - точки поваров (`lat/lng`) + статистика меню (`dishes_count`, `available_dishes_count`, `min_price`)
- `GET /api/cart/preview` - актуальные данные блюд для корзины
- `GET /api/subscriptions` - тарифы подписки
- `GET /api/orders` - список заказов
- `GET /api/orders/<id>` - детали заказа
- `POST /api/orders/<id>/status` - смена статуса заказа по pipeline
- `GET /api/payments` - список платежей (тестовый провайдер)
- `POST /api/orders` - создать заказ
- `POST /api/checkout` - оформить заказ по корзине с оплатой картой
- `POST /api/reviews` - добавить отзыв
- `POST /api/courier/book` - аренда курьера на день
- `POST /api/cooks/verification` - заявка на верификацию повара

## Структура

```text
.
├── backend/
│   ├── uploads/
│   ├── server.py
│   └── data/
│       ├── dishes.json
│       ├── cooks.json
│       ├── reviews.json
│       ├── payments.json
│       ├── subscriptions.json
│       ├── orders.json
│       └── runtime/
├── index.html
├── dish.html
├── cook.html
├── orders.html
├── styles.css
├── app.js
├── dish.js
├── cart.js
├── cook.js
├── orders.js
└── README.md
```

## Что уже готово

- Локальный landing + витрина блюд
- Фильтрация, сортировка, поиск
- Провал в карточку блюда и оформление заказа через API
- Остатки и доступность блюд по времени
- Корзина на несколько блюд и checkout одним заказом
- Оплата картой внутри checkout (MVP mock-провайдер, без хранения полного PAN)
- Трек статусов заказа и рабочая лента заказов для повара
- Отзывы по блюдам с влиянием на рейтинг в выдаче
- Интерактивная карта поваров на Яндекс.Картах + геокодирование адреса
- Повар может добавить блюдо с фото, граммовкой и своей ценой
- Блоки подписки, верификации, рейтинга и доставки

## Следующий этап (когда начнем "приложение")

- Авторизация (покупатель/повар/админ)
- Личный кабинет повара (меню, заказы, статус верификации)
- Кабинет покупателя (история заказов, избранное)
- Оплата и комиссии
- Переход на PostgreSQL + backend framework + мобильный клиент
